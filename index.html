<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WOW PDFs - The Ultimate PDF Tool Hub</title>
    
    <!-- REQUIRED LIBRARIES FOR PDF MANIPULATION -->
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script src="https://unpkg.com/ghostscript-wasm@1.0.12/dist/ghostscript-wasm.js"></script>

    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = `https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js`;
    </script>

    <style>
        :root {
            --bg-main: #0d0f14; --bg-navbar: #1c222d; --bg-card: #12151a; --bg-button: #1c222d;
            --accent-primary: #42f8f5; --accent-shade: #3ff7f3; --text-primary: #ffffff;
            --text-secondary: #c5d1de; --glow-shadow: rgba(66, 248, 245, 0.6);
            --glow-shadow-hover: rgba(66, 248, 245, 0.9); --border-color: #42f8f5; --error-color: #f84242;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif; background-color: var(--bg-main); color: var(--text-primary); line-height: 1.6; }
        ::-webkit-scrollbar { width: 8px; } ::-webkit-scrollbar-track { background: var(--bg-main); }
        ::-webkit-scrollbar-thumb { background: var(--accent-primary); border-radius: 10px; }
        .header { background-color: var(--bg-navbar); padding: 1rem 5%; position: sticky; top: 0; z-index: 1000; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.5); border-bottom: 1px solid var(--accent-primary); }
        .logo { font-size: 1.8rem; font-weight: bold; color: var(--text-primary); text-shadow: 0 0 5px var(--glow-shadow); cursor: pointer; }
        .logo-accent { color: var(--accent-primary); }
        .nav-links a { color: var(--text-primary); text-decoration: none; margin: 0 1rem; font-weight: 500; transition: color 0.3s ease, text-shadow 0.3s ease; }
        .nav-links a:hover { color: var(--accent-primary); text-shadow: 0 0 10px var(--glow-shadow); }
        .nav-toggle { display: none; font-size: 1.5rem; background: none; border: none; color: var(--text-primary); cursor: pointer; }
        .main-container { padding: 2rem 5%; } #tools { padding-top: 1rem; }
        .section-title { text-align: center; font-size: 2.5rem; margin-bottom: 2rem; color: var(--text-primary); text-shadow: 0 0 10px var(--glow-shadow); }
        .tool-grid { display: grid; gap: 1.5rem; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
        .tool-card { background-color: var(--bg-card); border: 1px solid var(--bg-navbar); border-radius: 8px; padding: 1.5rem; display: flex; flex-direction: column; justify-content: space-between; transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease; }
        .tool-card:hover { transform: translateY(-5px); border-color: var(--border-color); box-shadow: 0 0 15px var(--glow-shadow); }
        .tool-card h2 { color: var(--accent-primary); font-size: 1.5rem; margin-bottom: 0.5rem; }
        .tool-card p { color: var(--text-secondary); font-size: 1rem; flex-grow: 1; margin-bottom: 1.5rem; }
        .glow-button { background-color: var(--bg-button); color: var(--text-primary); border: 2px solid var(--border-color); border-radius: 5px; padding: 0.75rem 1.5rem; font-size: 1rem; font-weight: bold; cursor: pointer; text-align: center; text-transform: uppercase; transition: all 0.3s ease; box-shadow: 0 0 5px var(--glow-shadow); display: block; width: 100%; }
        .glow-button:hover, .glow-button:focus { background-color: var(--accent-primary); color: var(--bg-main); box-shadow: 0 0 20px var(--glow-shadow-hover); }
        .glow-button:disabled { cursor: not-allowed; background-color: #333; border-color: #555; box-shadow: none; color: #888; }
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.7); backdrop-filter: blur(5px); }
        .modal-content { background-color: var(--bg-main); margin: 5% auto; padding: 2rem; border: 1px solid var(--border-color); border-radius: 8px; width: 90%; max-width: 800px; box-shadow: 0 0 25px var(--glow-shadow); position: relative; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        .modal-close { color: var(--text-secondary); position: absolute; top: 1rem; right: 1.5rem; font-size: 2rem; font-weight: bold; cursor: pointer; transition: color 0.3s ease, transform 0.3s ease; }
        .modal-close:hover { color: var(--accent-primary); transform: scale(1.1); }
        .modal-header h2 { color: var(--accent-primary); font-size: 2rem; margin-bottom: 1rem; }
        .modal-body { max-height: 70vh; overflow-y: auto; padding-right: 10px; }
        .tool-ui-container { margin-top: 1.5rem; display: flex; flex-direction: column; gap: 1.5rem; }
        .tool-ui-container label, .form-group label { display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-weight: bold; }
        .tool-ui-container input[type="text"], .tool-ui-container input[type="number"], .tool-ui-container input[type="password"], .tool-ui-container textarea, .tool-ui-container select { width: 100%; padding: 0.75rem; background-color: var(--bg-button); border: 1px solid var(--bg-navbar); border-radius: 5px; color: var(--text-primary); font-size: 1rem; transition: border-color 0.3s, box-shadow 0.3s; }
        .tool-ui-container input[type="text"]:focus, .tool-ui-container input[type="number"]:focus, .tool-ui-container input[type="password"]:focus, .tool-ui-container textarea:focus, .tool-ui-container select:focus { outline: none; border-color: var(--border-color); box-shadow: 0 0 8px var(--glow-shadow); }
        .tool-ui-container input[type="file"] { display: none; }
        .file-upload-label { display: block; padding: 2rem; background-color: var(--bg-button); border: 2px dashed var(--border-color); border-radius: 5px; cursor: pointer; text-align: center; transition: background-color 0.3s; }
        .file-upload-label:hover { background-color: var(--bg-navbar); }
        .file-list p { background: var(--bg-card); padding: 0.5rem 1rem; border-radius: 4px; margin-top: 0.5rem; }
        .result-box { background-color: var(--bg-card); border: 1px solid var(--bg-navbar); padding: 1rem; border-radius: 5px; margin-top: 1rem; word-wrap: break-word; min-height: 50px; }
        .alert-message { padding: 1rem; margin-top: 1rem; border-radius: 5px; font-weight: bold; display: none; }
        .alert-message.success { background-color: rgba(66, 248, 245, 0.2); border: 1px solid var(--accent-primary); color: var(--accent-primary); }
        .alert-message.error { background-color: rgba(248, 66, 66, 0.2); border: 1px solid var(--error-color); color: var(--error-color); }
        #signature-pad { border: 2px solid var(--border-color); border-radius: 5px; cursor: crosshair; }
        .flex-group { display: flex; gap: 1rem; align-items: center; flex-wrap: wrap; }
        
        .footer {
            background-color: var(--bg-navbar);
            padding: 2rem 5%;
            margin-top: 4rem;
            text-align: center;
            border-top: 1px solid var(--border-color);
        }
        .footer-links { margin-bottom: 1rem; }
        .footer-links a { color: var(--text-secondary); text-decoration: none; margin: 0 1rem; transition: color 0.3s ease; }
        .footer-links a:hover { color: var(--accent-primary); }
        .footer-copyright { color: var(--text-secondary); font-size: 0.9rem; }
        .policy-container { padding-top: 4rem; }
        .policy-container section { margin-bottom: 4rem; max-width: 800px; margin-left: auto; margin-right: auto; }
        .policy-container p, .policy-container li { color: var(--text-secondary); margin-bottom: 1rem; line-height: 1.8; }
        .policy-container h3 { color: var(--accent-primary); margin-top: 2rem; margin-bottom: 1rem; }
        .policy-container ul { list-style-position: inside; padding-left: 1rem; }
        .contact-email { color: var(--accent-primary); text-decoration: none; }

        @media (max-width: 768px) { 
            .header { flex-direction: column; gap: 1rem; padding: 1rem 2rem; } 
            .nav-links { display: none; flex-direction: column; width: 100%; text-align: center; } 
            .nav-links.active { display: flex; } 
            .nav-links a { padding: 0.5rem 0; border-top: 1px solid var(--bg-button); } 
            .nav-toggle { display: block; position: absolute; top: 1.25rem; right: 1.25rem; } 
            .modal-content { width: 95%; margin: 10% auto; padding: 1.5rem; } 
            .footer-links a { display: block; padding: 0.5rem 0; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo">WOW<span class="logo-accent">PDFs</span></div>
        <nav class="nav-links">
            <a href="#tools">Home</a>
            <a href="#about">About</a>
            <a href="#contact">Contact</a>
        </nav>
        <button class="nav-toggle" aria-label="Toggle navigation">â˜°</button>
    </header>

    <main class="main-container" id="home">
        <section id="tools">
            <h1 class="section-title">The Ultimate PDF Tool Hub</h1>
            <div class="tool-grid"></div>
        </section>
    </main>

    <div class="main-container policy-container">
        <section id="about">
            <h2 class="section-title">About WOW PDFs</h2>
            <p>WOW PDFs was born from a simple idea: PDF tools should be powerful, fast, and private. In a world where data privacy is more important than ever, we wanted to create a suite of utilities that work entirely within your browser. This means your sensitive documents are never uploaded to a server. Everything you do on WOW PDFs stays on your computer.</p>
            <p>Our mission is to provide a premium, user-friendly experience without compromising on security. Using modern web technologies like WebAssembly, we bring server-grade performance directly to your frontend, giving you the best of both worlds: power and privacy.</p>
        </section>
        <section id="contact">
            <h2 class="section-title">Contact Us</h2>
            <p>Have questions, feedback, or suggestions? We'd love to hear from you. Please reach out to us via email:</p>
            <p style="text-align: center; font-size: 1.2rem; margin-top: 1rem;"><a href="mailto:support@yourdomain.com" class="contact-email">support@yourdomain.com</a></p>
            <p>(Please replace 'support@yourdomain.com' with your actual email address).</p>
        </section>
        <section id="privacy">
            <h2 class="section-title">Privacy Policy</h2>
            <p><strong>Last Updated: [Date]</strong></p>
            <p>At WOW PDFs, your privacy is our highest priority. This policy outlines our principles regarding the collection, use, and disclosure of personal information.</p>
            <h3>Core Privacy Principle: Zero Uploads</h3>
            <p>WOW PDFs is a 100% client-side application. This means that all PDF processing, including merging, splitting, compressing, and converting, happens directly in your web browser on your own computer. Your files are <strong>NEVER</strong> uploaded, sent to, or stored on our servers or any third-party server. We have no access to your documents at any time.</p>
            <h3>Information We Do Not Collect</h3>
            <p>We do not collect, store, or track any personal information or the content of the files you work with. This includes: Your name, email address, or other personal identifiers; The contents or metadata of your PDF or image files; Any data generated during the use of our tools.</p>
            <h3>Information We May Collect (Analytics)</h3>
            <p>To improve our website and understand which tools are most popular, we may use privacy-respecting analytics services (e.g., Google Analytics). This data is aggregated and anonymized and may include: The type of web browser and operating system you use; The pages you visit on our site and the tools you use; Your country of origin (but not your specific IP address).</p>
            <h3>Cookies</h3>
            <p>We may use cookies for essential site functionality or for the analytics services mentioned above. You can disable cookies in your browser settings, but this may affect the functionality of the site.</p>
            <h3>Changes to This Policy</h3>
            <p>We may update this Privacy Policy from time to time. We will notify you of any changes by posting the new policy on this page. You are advised to review this Privacy Policy periodically for any changes.</p>
        </section>
        <section id="terms">
            <h2 class="section-title">Terms & Conditions</h2>
            <p><strong>Last Updated: [Date]</strong></p>
            <p>By accessing and using WOW PDFs (the "Website"), you agree to be bound by these Terms and Conditions ("Terms"). If you disagree with any part of the terms, then you may not access the Website.</p>
            <h3>Use of Tools</h3>
            <p>The tools provided on this Website are for your personal and commercial use. They are provided on an "as is" basis. While we strive for accuracy and reliability, we do not guarantee that the tools will be error-free or that the output will be suitable for any specific purpose. All processing is done on your local machine, and we are not responsible for the content or the results of the processing.</p>
            <h3>Disclaimer of Warranties</h3>
            <p>The Website is provided without any warranties, express or implied. WOW PDFs does not warrant that the website will be available at all times, be secure, or be free of errors. You assume full responsibility and risk for your use of the Website and its tools.</p>
            <h3>Limitation of Liability</h3>
            <p>In no event shall WOW PDFs, nor its owners or operators, be liable for any indirect, incidental, special, consequential, or punitive damages, including without limitation, loss of data, loss of profits, or other intangible losses, resulting from your access to or use of or inability to access or use the Website.</p>
            <h3>Governing Law</h3>
            <p>These Terms shall be governed and construed in accordance with the laws of [Your Country/State], without regard to its conflict of law provisions.</p>
            <h3>Changes to Terms</h3>
            <p>We reserve the right, at our sole discretion, to modify or replace these Terms at any time. We will provide notice of any changes by posting the new Terms on this page.</p>
        </section>
    </div>

    <footer class="footer">
        <div class="footer-links">
            <a href="#about">About Us</a>
            <a href="#contact">Contact Us</a>
            <a href="#privacy">Privacy Policy</a>
            <a href="#terms">Terms & Conditions</a>
        </div>
        <div class="footer-copyright">
            Â© 2024 WOW PDFs. All Rights Reserved.
        </div>
    </footer>

    <div id="toolModal" class="modal">
        <div class="modal-content">
            <span class="modal-close">Ã—</span>
            <div class="modal-header"><h2 id="modal-title">Tool Title</h2></div>
            <div class="modal-body">
                <div id="modal-tool-ui" class="tool-ui-container"></div>
                <div id="modal-alert" class="alert-message"></div>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const { PDFDocument, rgb, degrees } = PDFLib;

        const tools = [
            { id: 'mergePdf', title: 'Merge PDF', description: 'Combine multiple PDF files into one single document.' },
            { id: 'splitPdf', title: 'Split PDF', description: 'Extract pages or split every page into a separate PDF.' },
            { id: 'compressPdf', title: 'Compress PDF', description: 'Reduce PDF file size with powerful, client-side compression.' },
            { id: 'rotatePdf', title: 'Rotate PDF', description: 'Rotate all or specific pages in your PDF document.' },
            { id: 'addWatermark', title: 'Add Watermark', description: 'Stamp text over your PDF pages with custom styling.' },
            { id: 'addPageNumbers', title: 'Add Page Numbers', description: 'Insert page numbers easily into your PDF file.' },
            { id: 'imageToPdf', title: 'Image to PDF', description: 'Convert JPG & PNG images into a PDF file.' },
            { id: 'pdfToJpg', title: 'PDF to JPG', description: 'Convert PDF pages to JPG images.' },
            { id: 'addSignature', title: 'Sign PDF', description: 'Draw your signature and add it to your PDF file.' },
            { id: 'extractText', title: 'Extract Text', description: 'Pull all text content from a PDF into a text document.' },
            { id: 'organizePdf', title: 'Organize PDF', description: 'Visually reorder pages (Complex UI - Conceptual).'},
        ];

        const toolGrid = document.querySelector('.tool-grid');
        const modal = document.getElementById('toolModal');
        const modalClose = document.querySelector('.modal-close');
        const modalTitle = document.getElementById('modal-title');
        const modalToolUi = document.getElementById('modal-tool-ui');
        const modalAlert = document.getElementById('modal-alert');
        const navToggle = document.querySelector('.nav-toggle');
        const navLinks = document.querySelector('.nav-links');

        function populateTools() {
            toolGrid.innerHTML = '';
            tools.forEach(tool => {
                const card = document.createElement('div');
                card.className = 'tool-card';
                card.innerHTML = `<h2>${tool.title}</h2><p>${tool.description}</p><button class="glow-button" data-tool-id="${tool.id}">Open Tool</button>`;
                toolGrid.appendChild(card);
            });
        }

        function openModal(toolId) {
            const tool = tools.find(t => t.id === toolId);
            if (!tool) return;
            modalTitle.textContent = tool.title;
            modalToolUi.innerHTML = '';
            hideAlert();
            renderToolUI(toolId);
            modal.style.display = 'block';
        }

        function closeModal() { modal.style.display = 'none'; }
        function showAlert(message, type = 'success') { modalAlert.textContent = message; modalAlert.className = `alert-message ${type}`; modalAlert.style.display = 'block'; }
        function hideAlert() { modalAlert.style.display = 'none'; }

        toolGrid.addEventListener('click', (e) => { if (e.target.classList.contains('glow-button')) openModal(e.target.dataset.toolId); });
        modalClose.addEventListener('click', closeModal);
        window.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });
        navToggle.addEventListener('click', () => {
            document.querySelector('.nav-links').classList.toggle('active');
        });

        function downloadFile(bytes, fileName, mimeType) {
            const blob = new Blob([bytes], { type: mimeType });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(link.href);
        }
        
        function renderToolUI(toolId) {
            const tool = tools.find(t => t.id === toolId);
            switch (toolId) {
                case 'mergePdf':
                    modalToolUi.innerHTML = `<label for="file-upload" class="file-upload-label">Select PDF Files (2 or more)</label><input type="file" id="file-upload" accept=".pdf" multiple><div id="file-list" class="file-list"></div><button id="process-btn" class="glow-button" disabled>Merge PDFs</button>`;
                    setupFileProcessor({
                        buttonId: 'process-btn', minFiles: 2,
                        processFunction: async (files) => {
                            showAlert('Merging PDFs...', 'success');
                            const mergedPdf = await PDFDocument.create();
                            for (const file of files) {
                                const pdfDoc = await PDFDocument.load(await file.arrayBuffer());
                                const copiedPages = await mergedPdf.copyPages(pdfDoc, pdfDoc.getPageIndices());
                                copiedPages.forEach(page => mergedPdf.addPage(page));
                            }
                            downloadFile(await mergedPdf.save(), 'wow-pdf-merged.pdf', 'application/pdf');
                            hideAlert();
                        }
                    });
                    break;
                case 'splitPdf':
                    modalToolUi.innerHTML = `<label for="file-upload" class="file-upload-label">Select PDF File</label><input type="file" id="file-upload" accept=".pdf"><div id="file-list" class="file-list"></div><div class="form-group"><label for="split-range">Page ranges (e.g., 1-3, 5, 8-10):</label><input type="text" id="split-range" placeholder="Leave blank to split all pages"></div><button id="process-btn" class="glow-button" disabled>Split PDF</button>`;
                    setupFileProcessor({
                        buttonId: 'process-btn', maxFiles: 1,
                        processFunction: async (files) => {
                            showAlert('Splitting PDF...', 'success');
                            const pdfDoc = await PDFDocument.load(await files[0].arrayBuffer());
                            const rangeInput = document.getElementById('split-range').value.trim();
                            if (rangeInput) {
                                const newPdfDoc = await PDFDocument.create();
                                const pagesToCopy = new Set();
                                const totalPages = pdfDoc.getPageCount();
                                rangeInput.split(',').forEach(part => {
                                    if (part.includes('-')) { const [start, end] = part.split('-').map(Number); for (let i = start; i <= end; i++) pagesToCopy.add(i - 1); }
                                    else { pagesToCopy.add(Number(part) - 1); }
                                });
                                const copiedPages = await newPdfDoc.copyPages(pdfDoc, Array.from(pagesToCopy).filter(p => p >= 0 && p < totalPages));
                                copiedPages.forEach(p => newPdfDoc.addPage(p));
                                downloadFile(await newPdfDoc.save(), 'wow-pdf-split-range.pdf', 'application/pdf');
                            } else {
                                for (let i = 0; i < pdfDoc.getPageCount(); i++) {
                                    const newPdfDoc = await PDFDocument.create();
                                    const [copiedPage] = await newPdfDoc.copyPages(pdfDoc, [i]);
                                    newPdfDoc.addPage(copiedPage);
                                    downloadFile(await newPdfDoc.save(), `wow-pdf-page-${i + 1}.pdf`, 'application/pdf');
                                }
                            }
                            hideAlert();
                        }
                    });
                    break;
                case 'compressPdf':
                    modalToolUi.innerHTML = `<label for="file-upload" class="file-upload-label">Select PDF File to Compress</label><input type="file" id="file-upload" accept=".pdf"><div id="file-list" class="file-list"></div><div class="form-group"><label for="compression-level">Compression Level:</label><select id="compression-level"><option value="/ebook">Recommended (Good balance)</option><option value="/screen">Basic (Lowest quality, smallest size)</option><option value="/printer">High Quality (Larger size)</option><option value="/prepress">Max Quality (Almost no compression)</option></select></div><button id="process-btn" class="glow-button" disabled>Compress PDF</button>`;
                    setupFileProcessor({
                        buttonId: 'process-btn', maxFiles: 1,
                        processFunction: async (files) => {
                            const file = files[0];
                            const level = document.getElementById('compression-level').value;
                            showAlert('Loading compression engine (this may take a moment)...', 'success');
                            const gs = await ghostscript_wasm();
                            showAlert('Engine loaded. Compressing PDF...', 'success');
                            const inputBytes = await file.arrayBuffer();
                            await gs.writeFile(file.name, new Uint8Array(inputBytes));
                            await gs.run('-sDEVICE=pdfwrite', `-dPDFSETTINGS=${level}`, '-dCompatibilityLevel=1.4', '-dNOPAUSE', '-dBATCH', '-sOutputFile=output.pdf', file.name);
                            const outputBytes = await gs.readFile('output.pdf');
                            downloadFile(outputBytes, `wow-pdf-compressed.pdf`, 'application/pdf');
                            hideAlert();
                            await gs.exit();
                        }
                    });
                    break;
                case 'rotatePdf':
                    modalToolUi.innerHTML = `<label for="file-upload" class="file-upload-label">Select PDF File</label><input type="file" id="file-upload" accept=".pdf"><div id="file-list" class="file-list"></div><div class="form-group"><label for="rotation-angle">Rotation Angle:</label><select id="rotation-angle"><option value="90">90Â° Clockwise</option><option value="180">180Â°</option><option value="270">270Â° Clockwise (90Â° Counter-clockwise)</option></select></div><button id="process-btn" class="glow-button" disabled>Rotate PDF</button>`;
                    setupFileProcessor({
                        buttonId: 'process-btn', maxFiles: 1,
                        processFunction: async (files) => {
                            showAlert('Rotating PDF...', 'success');
                            const angle = parseInt(document.getElementById('rotation-angle').value);
                            const pdfDoc = await PDFDocument.load(await files[0].arrayBuffer());
                            const pages = pdfDoc.getPages();
                            pages.forEach(page => {
                                const currentRotation = page.getRotation().angle;
                                page.setRotation(degrees(currentRotation + angle));
                            });
                            downloadFile(await pdfDoc.save(), 'wow-pdf-rotated.pdf', 'application/pdf');
                            hideAlert();
                        }
                    });
                    break;
                case 'addWatermark':
                    modalToolUi.innerHTML = `<label for="file-upload" class="file-upload-label">Select PDF File</label><input type="file" id="file-upload" accept=".pdf"><div id="file-list" class="file-list"></div><div class="form-group"><label for="watermark-text">Watermark Text:</label><input type="text" id="watermark-text" value="CONFIDENTIAL"></div><div class="flex-group"><div class="form-group"><label for="font-size">Font Size:</label><input type="number" id="font-size" value="72"></div><div class="form-group"><label for="opacity">Opacity (0-1):</label><input type="number" id="opacity" value="0.2" step="0.1" min="0" max="1"></div></div><button id="process-btn" class="glow-button" disabled>Add Watermark</button>`;
                    setupFileProcessor({
                        buttonId: 'process-btn', maxFiles: 1,
                        processFunction: async (files) => {
                            showAlert('Adding watermark...', 'success');
                            const text = document.getElementById('watermark-text').value;
                            const fontSize = parseInt(document.getElementById('font-size').value);
                            const opacity = parseFloat(document.getElementById('opacity').value);
                            const pdfDoc = await PDFDocument.load(await files[0].arrayBuffer());
                            const pages = pdfDoc.getPages();
                            for (const page of pages) {
                                page.drawText(text, {
                                    x: page.getWidth() / 2 - (text.length * fontSize / 4),
                                    y: page.getHeight() / 2,
                                    size: fontSize,
                                    color: rgb(0.5, 0.5, 0.5),
                                    opacity: opacity,
                                    rotate: degrees(45),
                                });
                            }
                            downloadFile(await pdfDoc.save(), 'wow-pdf-watermarked.pdf', 'application/pdf');
                            hideAlert();
                        }
                    });
                    break;
                case 'addPageNumbers':
                    modalToolUi.innerHTML = `<label for="file-upload" class="file-upload-label">Select PDF File</label><input type="file" id="file-upload" accept=".pdf"><div id="file-list" class="file-list"></div><div class="form-group"><label for="position">Position:</label><select id="position"><option value="bottom-center">Bottom Center</option><option value="bottom-right">Bottom Right</option><option value="top-center">Top Center</option><option value="top-right">Top Right</option></select></div><button id="process-btn" class="glow-button" disabled>Add Page Numbers</button>`;
                    setupFileProcessor({
                        buttonId: 'process-btn', maxFiles: 1,
                        processFunction: async (files) => {
                            showAlert('Adding page numbers...', 'success');
                            const position = document.getElementById('position').value;
                            const pdfDoc = await PDFDocument.load(await files[0].arrayBuffer());
                            const pages = pdfDoc.getPages();
                            for (let i = 0; i < pages.length; i++) {
                                const page = pages[i];
                                const pageNum = (i + 1).toString();
                                const { width, height } = page.getSize();
                                let x, y;
                                switch(position) {
                                    case 'bottom-right': x = width - 40; y = 20; break;
                                    case 'top-center': x = width / 2; y = height - 40; break;
                                    case 'top-right': x = width - 40; y = height - 40; break;
                                    default: x = width / 2; y = 20; break;
                                }
                                page.drawText(pageNum, { x, y, size: 12, color: rgb(0, 0, 0) });
                            }
                            downloadFile(await pdfDoc.save(), 'wow-pdf-numbered.pdf', 'application/pdf');
                            hideAlert();
                        }
                    });
                    break;
                case 'imageToPdf':
                    modalToolUi.innerHTML = `<label for="file-upload" class="file-upload-label">Select Image Files (JPG, PNG)</label><input type="file" id="file-upload" accept="image/jpeg,image/png" multiple><div id="file-list" class="file-list"></div><button id="process-btn" class="glow-button" disabled>Convert to PDF</button>`;
                    setupFileProcessor({
                        buttonId: 'process-btn',
                        processFunction: async (files) => {
                            showAlert('Converting images...', 'success');
                            const pdfDoc = await PDFDocument.create();
                            for (const file of files) {
                                const imgBytes = await file.arrayBuffer();
                                const image = file.type === 'image/png' ? await pdfDoc.embedPng(imgBytes) : await pdfDoc.embedJpg(imgBytes);
                                const page = pdfDoc.addPage([image.width, image.height]);
                                page.drawImage(image, { x: 0, y: 0, width: image.width, height: image.height });
                            }
                            downloadFile(await pdfDoc.save(), 'wow-pdf-from-images.pdf', 'application/pdf');
                            hideAlert();
                        }
                    });
                    break;
                case 'pdfToJpg':
                    modalToolUi.innerHTML = `<label for="file-upload" class="file-upload-label">Select PDF File</label><input type="file" id="file-upload" accept=".pdf"><div id="file-list" class="file-list"></div><button id="process-btn" class="glow-button" disabled>Convert Pages to JPG</button>`;
                    setupFileProcessor({
                        buttonId: 'process-btn', maxFiles: 1,
                        processFunction: async (files) => {
                            showAlert('Converting pages to JPG...', 'success');
                            const pdfDoc = await pdfjsLib.getDocument({data: await files[0].arrayBuffer()}).promise;
                            for (let i = 1; i <= pdfDoc.numPages; i++) {
                                const page = await pdfDoc.getPage(i);
                                const viewport = page.getViewport({ scale: 1.5 });
                                const canvas = document.createElement('canvas');
                                const context = canvas.getContext('2d');
                                canvas.height = viewport.height; canvas.width = viewport.width;
                                await page.render({ canvasContext: context, viewport: viewport }).promise;
                                canvas.toBlob(blob => downloadFile(blob, `wow-pdf-page-${i}.jpg`, 'image/jpeg'), 'image/jpeg', 0.9);
                            }
                            setTimeout(hideAlert, 500);
                        }
                    });
                    break;
                case 'addSignature':
                    modalToolUi.innerHTML = `<label for="file-upload" class="file-upload-label">1. Select PDF File</label><input type="file" id="file-upload" accept=".pdf"><div id="file-list" class="file-list"></div><div class="form-group"><label>2. Draw your signature below</label><canvas id="signature-pad" width="400" height="200"></canvas><button id="clear-signature" class="glow-button" style="width:auto; margin-top:0.5rem;">Clear</button></div><button id="process-btn" class="glow-button" disabled>Add Signature to PDF</button>`;
                    setupSignatureTool();
                    break;
                case 'extractText':
                    modalToolUi.innerHTML = `<label for="file-upload" class="file-upload-label">Select PDF File</label><input type="file" id="file-upload" accept=".pdf"><div id="file-list" class="file-list"></div><button id="process-btn" class="glow-button" disabled>Extract All Text</button>`;
                    setupFileProcessor({
                        buttonId: 'process-btn', maxFiles: 1,
                        processFunction: async (files) => {
                            showAlert('Extracting text...', 'success');
                            const pdfDoc = await pdfjsLib.getDocument({data: await files[0].arrayBuffer()}).promise;
                            let fullText = '';
                            for (let i = 1; i <= pdfDoc.numPages; i++) {
                                const page = await pdfDoc.getPage(i);
                                const textContent = await page.getTextContent();
                                fullText += textContent.items.map(item => item.str).join(' ') + '\n\n';
                            }
                            downloadFile(new TextEncoder().encode(fullText), 'wow-pdf-extracted-text.txt', 'text/plain');
                            hideAlert();
                        }
                    });
                    break;
                case 'organizePdf':
                    modalToolUi.innerHTML = `<p style="color:var(--text-secondary); text-align: center;">Building a visual drag-and-drop page organizer is a highly complex UI task and is considered a conceptual feature for this project.</p>`;
                    break;
            }
        }
        
        function setupFileProcessor({ buttonId, minFiles = 1, maxFiles = Infinity, processFunction }) {
            const fileInput = document.getElementById('file-upload');
            const fileListDiv = document.getElementById('file-list');
            const processBtn = document.getElementById('process-btn');
            fileInput.onchange = () => {
                fileListDiv.innerHTML = Array.from(fileInput.files).map(f => `<p>${f.name}</p>`).join('');
                processBtn.disabled = fileInput.files.length < minFiles || fileInput.files.length > maxFiles;
            };
            processBtn.onclick = async () => {
                const originalText = processBtn.textContent;
                try {
                    processBtn.disabled = true;
                    processBtn.textContent = 'Processing...';
                    await processFunction(Array.from(fileInput.files));
                } catch (error) {
                    console.error(error);
                    showAlert(`An error occurred: ${error.message}`, 'error');
                } finally {
                    processBtn.disabled = false;
                    processBtn.textContent = originalText;
                }
            };
        }

        function setupSignatureTool() {
            const canvas = document.getElementById('signature-pad');
            const ctx = canvas.getContext('2d');
            let drawing = false;
            ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--accent-primary').trim();
            ctx.lineWidth = 2;
            canvas.addEventListener('mousedown', () => { drawing = true; ctx.beginPath(); });
            canvas.addEventListener('mouseup', () => { drawing = false; });
            canvas.addEventListener('mousemove', (e) => {
                if (!drawing) return;
                const rect = canvas.getBoundingClientRect();
                ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
                ctx.stroke();
            });
            document.getElementById('clear-signature').onclick = () => ctx.clearRect(0, 0, canvas.width, canvas.height);
            setupFileProcessor({
                buttonId: 'process-btn', maxFiles: 1,
                processFunction: async (files) => {
                    showAlert('Adding signature...', 'success');
                    const signatureImgBytes = await new Promise(resolve => canvas.toBlob(blob => {
                        const reader = new FileReader(); reader.onloadend = () => resolve(reader.result); reader.readAsArrayBuffer(blob);
                    }, 'image/png'));
                    const pdfDoc = await PDFDocument.load(await files[0].arrayBuffer());
                    const signatureImage = await pdfDoc.embedPng(signatureImgBytes);
                    const lastPage = pdfDoc.getPage(pdfDoc.getPageCount() - 1);
                    lastPage.drawImage(signatureImage, { x: lastPage.getWidth() - 150, y: 50, width: 120, height: 60 });
                    downloadFile(await pdfDoc.save(), 'wow-pdf-signed.pdf', 'application/pdf');
                    hideAlert();
                }
            });
        }
        populateTools();
    });
    </script>
</body>
</html>
